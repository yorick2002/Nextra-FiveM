---
title: Sandboxing
description: Guide for understanding sandboxing within FXServer, including the security restrictions and allowed operations for resources.
---

import { Callout } from 'nextra/components';

<Callout type="warning">
This entire page content is copied from the file in the [FiveM Docs Repository](https://github.com/citizenfx/fivem-docs/blob/master/content/docs/developers/sandbox.md) by CFX.re.
</Callout>

---

## What is Sandboxing?

FiveM implements a security sandbox to ensure the stability of resources and to prevent malicious code execution. This document explains the restrictions in place and the allowed APIs within this sandbox environment.

---

## File System Operations

### Path Types

There are two types of paths supported for file system operations:

1. **Resource mount paths** (Recommended): `@resourceName/path`
2. **Absolute paths**: `/absolute/path/to/resource`

It is highly recommended to use **resource mount paths** as they are cleaner and more portable.

### Directory Listing

The `io.readdir()` function is used to return the list of files and folders within a directory:

```lua
-- Using mount paths (recommended)
local files1 = io.readdir("@myResource/")
local files2 = io.readdir("@myResource/assets")

-- Using absolute paths
local files3 = io.readdir("/absolute/path/to/resource")
local files4 = io.readdir("/absolute/path/to/resource/assets")
```

You can iterate over the list of files like this:

```lua
local files = io.readdir("@myResource/")
for _, file in ipairs(files) do
    print(file) -- Process each file
end
```

### File Operations

Here’s how you can open files using either resource mount or absolute paths:

```lua
-- Using mount paths (recommended)
local file1 = io.open("@myResource/data.json", "r")

-- Using absolute paths
local file2 = io.open("/absolute/path/to/resource/data.json", "r")

-- Available modes:
-- "r"  -- Read
-- "w"  -- Write
-- "a"  -- Append
-- "+"  -- Create
```

#### Write Restrictions

Certain file types are blocked for writing across resources to prevent code injection:

- `.lua` – Lua source files
- `.dll` – Dynamic Link Libraries
- `.ts` – TypeScript files
- `.js`, `.mjs`, `.cjs` – JavaScript files
- `.cs` – C# source files

**Note:** Writing to these file types is allowed **within the same resource**, but blocked when attempting to write across different resources.

The `SaveResourceFile` native function follows the same restrictions.

### System Path Restrictions

- **Blocked:** Operations in the server main folder or outside resource folders.
- **Error code 13** ("Permission denied") is returned for blocked operations.

---

## OS Operations

### Time Functions

New time-related functions are available:

```lua
local nano = os.nanotime()   -- Nanosecond precision
local micro = os.microtime() -- Microsecond precision
local delta = os.deltatime() -- Time difference
local tsc = os.rdtsc()       -- Read Time-Stamp Counter
local tscp = os.rdtscp()     -- Read Time-Stamp Counter and Processor ID
```

### Restricted Operations

The following operations are blocked, and will return a "Permission denied" (code 13) error:

```lua
os.execute("command")  -- All commands are blocked
io.tmpfile()           -- Temporary files are blocked
io.popen(command .. resourcePath .. path .. suffix)    -- Only 'ls' and 'dir' commands are emulated
```

### Limited Functionality

Some operations are allowed but with limited functionality:

```lua
os.getenv("os") -- Returns the current OS (Windows/Linux)
os.setlocale()  -- Returns current locale, cannot modify
```

### Allowed Operations

The following operations remain available without restrictions:

```lua
load() -- Loading code is not blocked
```

---

## File System Permissions

To allow specific resources to write to other resources, bypassing the default file extension restrictions, use the `add_filesystem_permission` configuration:

```lua
-- Allow resourceA to write any file type to resourceB
add_filesystem_permission resourceA write resourceB
```

This override grants full write access, regardless of file type, and requires matching author names to authorize write access.

### ConVar Permissions

To restrict access to ConVars by specific resources, use the `add_convar_permission` configuration:

```lua
-- Restrict reading of a ConVar to specific resources
add_convar_permission resourceA read some_convar_name
```